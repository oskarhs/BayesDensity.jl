<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>RandomBernsteinPoly · BayesDensity.jl</title><meta name="title" content="RandomBernsteinPoly · BayesDensity.jl"/><meta property="og:title" content="RandomBernsteinPoly · BayesDensity.jl"/><meta property="twitter:title" content="RandomBernsteinPoly · BayesDensity.jl"/><meta name="description" content="Documentation for BayesDensity.jl."/><meta property="og:description" content="Documentation for BayesDensity.jl."/><meta property="twitter:description" content="Documentation for BayesDensity.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="BayesDensity.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BayesDensity.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../density_estimation_primer/">A primer on Bayesian nonparametric density estimation</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/general_api/">General API</a></li><li><a class="tocitem" href="../../api/plotting_api/">Plotting API</a></li></ul></li><li><span class="tocitem">Methods</span><ul><li><a class="tocitem" href="../">Index</a></li><li><a class="tocitem" href="../BSplineMixture/">BSplineMixture</a></li><li><a class="tocitem" href="../HistSmoother/">HistSmoother</a></li><li><a class="tocitem" href="../PitmanYorMixture/">PitmanYorMixture</a></li><li><a class="tocitem" href="../FiniteGaussianMixture/">FiniteGaussianMixture</a></li><li><a class="tocitem" href="../RandomFiniteGaussianMixture/">RandomFiniteGaussianMixture</a></li><li class="is-active"><a class="tocitem" href>RandomBernsteinPoly</a><ul class="internal"><li><a class="tocitem" href="#Module-API"><span>Module API</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/naive_bayes/">Naive Bayes</a></li><li><a class="tocitem" href="../../examples/model_selection/">Model selection</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/add_new_models/">Implementing new Bayesian density estimators</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>RandomBernsteinPoly</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>RandomBernsteinPoly</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oskarhs/BayesDensity.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oskarhs/BayesDensity.jl/blob/main/docs/src/methods/RandomBernsteinPoly.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="RandomBernsteinPoly"><a class="docs-heading-anchor" href="#RandomBernsteinPoly">RandomBernsteinPoly</a><a id="RandomBernsteinPoly-1"></a><a class="docs-heading-anchor-permalink" href="#RandomBernsteinPoly" title="Permalink"></a></h1><p>Documentation for random Bernstein polynomials (<a href="../../references/#Petrone1999bernstein">Petrone, 1999</a>).</p><p><code>RandomBernsteinPoly</code> models the data-generating density as a mixture of fixed <span>$\text{Beta}$</span> distributions with an unknown number of mixture components. The smoothness of the density estiates is primarily controlled through the number of basis densities <span>$K$</span>, which is selected in a data-driven manner. Mathematically, the Bernstein density model and prior distribution takes the following form,</p><p class="math-container">\[\begin{align*}
x_i \,|\, K, \boldsymbol{w} &amp;\sim \sum_{k=1}^K w_{k}b_{K,k}(x_i), &amp;i = 1,\ldots, n,\\
\boldsymbol{w} \,|\, K &amp;\sim \text{Dirichlet}_K(a/K, \ldots, a/K),\\
K &amp;\sim p(K),
\end{align*}\]</p><p>where <span>$b_{K,k}(\cdot)$</span> denotes the probability density function of the <span>$\text{Beta}(k, K-k+1)$</span>-distribution, <span>$a&gt; 0$</span> a fixed hyperparameter and <span>$p(K)$</span> is a probability mass function supported on a finite subset of the positive integers.</p><p>Although this model is formulated in terms of data on the unit interval, it can be also be applied more broadly to data on the entire real line. By default, we estimate the support of the Bernstein density based on the extrema of the data set, but it is also possible to use a prespecified support via the <code>bounds</code> keyword argument.</p><p>This module implements the Gibbs sampler of <a href="../../references/#Petrone1999bernstein">Petrone (1999)</a> for Markov chain Monte Carlo-based posterior inference.</p><div class="admonition is-info" id="Note-7bea674fc3157850"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-7bea674fc3157850" title="Permalink"></a></header><div class="admonition-body"><p>Keep in mind that this sampler is quite slow even for moderate sample sizes, due to the expensive sweeps involved in the Gibbs sampler.</p></div></div><h2 id="Module-API"><a class="docs-heading-anchor" href="#Module-API">Module API</a><a id="Module-API-1"></a><a class="docs-heading-anchor-permalink" href="#Module-API" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="BayesDensityRandomBernsteinPoly.RandomBernsteinPoly"><a class="docstring-binding" href="#BayesDensityRandomBernsteinPoly.RandomBernsteinPoly"><code>BayesDensityRandomBernsteinPoly.RandomBernsteinPoly</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">RandomBernsteinPoly{T&lt;:Real} &lt;: AbstractBayesDensityModel{T}</code></pre><p>Struct representing a random Bernstein polyomial.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">RandomBernsteinPoly(x::AbstractVector{&lt;:Real}; kwargs...)
RandomBernsteinPoly{T}(x::AbstractVector{&lt;:Real}; kwargs...)</code></pre><p><strong>Arguments</strong></p><ul><li><code>x</code>: The data vector.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>prior_components</code>: A <a href="https://juliastats.org/Distributions.jl/stable/univariate/#Distributions.DiscreteNonParametric"><code>Distributions.DiscreteNonParametric</code></a> distribution instance specifying the prior on the number of components <code>K</code>. Defaults to <code>DiscreteNonParametric(1:50, fill(T(1/50), 50))</code>, corresponding to a uniform prior on the set {1, …, 50}.</li><li><code>prior_strength</code>: Strength parameter of the symmetric Dirichlet prior on the mixture weights. E.g. the prior on the mixture weights is Dirichlet(strength/K, ..., strength/K) conditional on the number of mixture components being equal to <code>K</code>. Defaults to <code>1.0</code>.</li><li><code>bounds</code>: A tuple giving the support of the B-spline mixture model.</li></ul><p><strong>Returns</strong></p><ul><li><code>rbp</code>: A random Bernstein polynomial model object.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; x = (1.0 .- (1.0 .- LinRange(0.0, 1.0, 5000)) .^(1/3)).^(1/3);

julia&gt; rbp = RandomBernsteinPoly(x)
RandomBernsteinPoly{Float64} with 100 values for the number mixture components.
Using 5000 observations.
Hyperparameters:
 prior_strength = 1.0

julia&gt; fgm = RandomBernsteinPoly(x; prior_strength = 0.5, prior_components = DiscreteNonParametric(1:25, fill(1/25, 25)));</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oskarhs/BayesDensity.jl/blob/3d589f9813cb1defc1cede41716d4fb2a0541541/lib/BayesDensityRandomBernsteinPoly/src/RandomBernsteinPoly.jl#L1-L33">source</a></section></details></article><h3 id="Evaluating-the-pdf-and-cdf"><a class="docs-heading-anchor" href="#Evaluating-the-pdf-and-cdf">Evaluating the pdf and cdf</a><a id="Evaluating-the-pdf-and-cdf-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluating-the-pdf-and-cdf" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Distributions.pdf-Tuple{RandomBernsteinPoly, NamedTuple, Real}"><a class="docstring-binding" href="#Distributions.pdf-Tuple{RandomBernsteinPoly, NamedTuple, Real}"><code>Distributions.pdf</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">pdf(
    bsm::RandomBernsteinPoly,
    params::NamedTuple,
    t::Union{Real, AbstractVector{&lt;:Real}}
) -&gt; Union{Real, Vector{&lt;:Real}}

pdf(
    bsm::RandomBernsteinPoly,
    params::AbstractVector{NamedTuple},
    t::Union{Real, AbstractVector{&lt;:Real}}
) -&gt; Matrix{&lt;:Real}</code></pre><p>Evaluate <span>$f(t\, |\, \boldsymbol{\eta})$</span> for a given <code>RandomBernsteinPoly</code> when the model parameters of the NamedTuple <code>params</code> are given by <span>$\boldsymbol{\eta}$</span>.</p><p>The named tuple should contain fields named <code>:w</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oskarhs/BayesDensity.jl/blob/3d589f9813cb1defc1cede41716d4fb2a0541541/lib/BayesDensityRandomBernsteinPoly/src/RandomBernsteinPoly.jl#L84-L100">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Distributions.cdf-Tuple{RandomBernsteinPoly, NamedTuple, Real}"><a class="docstring-binding" href="#Distributions.cdf-Tuple{RandomBernsteinPoly, NamedTuple, Real}"><code>Distributions.cdf</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cdf(
    bsm::RandomBernsteinPoly,
    params::NamedTuple,
    t::Union{Real, AbstractVector{&lt;:Real}}
) -&gt; Union{Real, Vector{&lt;:Real}}

cdf(
    bsm::RandomBernsteinPoly,
    params::AbstractVector{NamedTuple},
    t::Union{Real, AbstractVector{&lt;:Real}}
) -&gt; Matrix{&lt;:Real}</code></pre><p>Evaluate <span>$F(t\, |\, \boldsymbol{\eta})$</span> for a given <code>RandomBernsteinPoly</code> when the model parameters of the NamedTuple <code>params</code> are given by <span>$\boldsymbol{\eta}$</span>.</p><p>The named tuple should contain fields named <code>:w</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oskarhs/BayesDensity.jl/blob/3d589f9813cb1defc1cede41716d4fb2a0541541/lib/BayesDensityRandomBernsteinPoly/src/RandomBernsteinPoly.jl#L106-L122">source</a></section></details></article><h3 id="Utility-functions"><a class="docs-heading-anchor" href="#Utility-functions">Utility functions</a><a id="Utility-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-functions" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="BayesDensityCore.hyperparams-Tuple{RandomBernsteinPoly}"><a class="docstring-binding" href="#BayesDensityCore.hyperparams-Tuple{RandomBernsteinPoly}"><code>BayesDensityCore.hyperparams</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hyperparams(
    rbp::RandomBernsteinPoly{T}
) where {T} -&gt; @NamedTuple{prior_components::DiscreteNonParametric{Int, T}, prior_strength::T}</code></pre><p>Returns the hyperparameters of the random Bernstein polynomial <code>rbp</code> as a <code>NamedTuple</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oskarhs/BayesDensity.jl/blob/3d589f9813cb1defc1cede41716d4fb2a0541541/lib/BayesDensityRandomBernsteinPoly/src/RandomBernsteinPoly.jl#L60-L66">source</a></section></details></article><h3 id="Markov-chain-Monte-Carlo"><a class="docs-heading-anchor" href="#Markov-chain-Monte-Carlo">Markov chain Monte Carlo</a><a id="Markov-chain-Monte-Carlo-1"></a><a class="docs-heading-anchor-permalink" href="#Markov-chain-Monte-Carlo" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="StatsBase.sample-Tuple{AbstractRNG, RandomBernsteinPoly, Int64}"><a class="docstring-binding" href="#StatsBase.sample-Tuple{AbstractRNG, RandomBernsteinPoly, Int64}"><code>StatsBase.sample</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">sample(
    [rng::Random.AbstractRNG],
    rbp::RandomBernsteinPoly{T},
    n_samples::Int;
    n_burnin::Int              = min(1000, div(n_samples, 5)),
    initial_params::NamedTuple = _get_default_initparams_mcmc(rbp)
) where {T} -&gt; PosteriorSamples{T}</code></pre><p>Generate <code>n_samples</code> posterior samples from a <code>RandomBernsteinPoly</code> using the telescope sampler.</p><p><strong>Arguments</strong></p><ul><li><code>rng</code>: Optional random seed used for random variate generation.</li><li><code>rbp</code>: The <code>RandomBernsteinPoly</code> object for which posterior samples are generated.</li><li><code>n_samples</code>: The total number of samples (including burn-in).</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>n_burnin</code>: Number of burn-in samples.</li><li><code>initial_params</code>: Initial values used in the MCMC algorithm. Should be supplied as a <code>NamedTuple</code> with a single field <code>K</code>, where <code>K</code> is a positive integer. Defaults to the integer nearest to <code>0.5*sqrt(n)</code> which has positive prior probability, where <code>n</code> is the sample size.</li></ul><p><strong>Returns</strong></p><ul><li><code>ps</code>: A <a href="../../api/general_api/#BayesDensityCore.PosteriorSamples"><code>PosteriorSamples</code></a> object holding the posterior samples and the original model object.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Random

julia&gt; x = (1.0 .- (1.0 .- LinRange(0.0, 1.0, 5000)) .^(1/3)).^(1/3);

julia&gt; rbp = RandomBernsteinPoly(x);

julia&gt; ps1 = sample(rbp, 5_000);

julia&gt; ps2 = sample(rbp, 5_000; n_burnin=2_000, initial_params = (K = 5,));</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oskarhs/BayesDensity.jl/blob/3d589f9813cb1defc1cede41716d4fb2a0541541/lib/BayesDensityRandomBernsteinPoly/src/mcmc.jl#L1-L36">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../RandomFiniteGaussianMixture/">« RandomFiniteGaussianMixture</a><a class="docs-footer-nextpage" href="../../examples/naive_bayes/">Naive Bayes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 15 February 2026 17:20">Sunday 15 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
