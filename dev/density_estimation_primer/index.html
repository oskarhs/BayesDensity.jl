<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A primer on Bayesian nonparametric density estimation · BayesDensity.jl</title><meta name="title" content="A primer on Bayesian nonparametric density estimation · BayesDensity.jl"/><meta property="og:title" content="A primer on Bayesian nonparametric density estimation · BayesDensity.jl"/><meta property="twitter:title" content="A primer on Bayesian nonparametric density estimation · BayesDensity.jl"/><meta name="description" content="Documentation for BayesDensity.jl."/><meta property="og:description" content="Documentation for BayesDensity.jl."/><meta property="twitter:description" content="Documentation for BayesDensity.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="BayesDensity.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesDensity.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>A primer on Bayesian nonparametric density estimation</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#The-Bayesian-approach"><span>The Bayesian approach</span></a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api/general_api/">General API</a></li><li><a class="tocitem" href="../api/plotting_api/">Plotting API</a></li></ul></li><li><span class="tocitem">Methods</span><ul><li><a class="tocitem" href="../methods/">Index</a></li><li><a class="tocitem" href="../methods/BSplineMixture/">BSplineMixture</a></li><li><a class="tocitem" href="../methods/HistSmoother/">HistSmoother</a></li><li><a class="tocitem" href="../methods/PitmanYorMixture/">PitmanYorMixture</a></li><li><a class="tocitem" href="../methods/FiniteGaussianMixture/">FiniteGaussianMixture</a></li><li><a class="tocitem" href="../methods/RandomFiniteGaussianMixture/">RandomFiniteGaussianMixture</a></li><li><a class="tocitem" href="../methods/RandomBernsteinPoly/">RandomBernsteinPoly</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/naive_bayes/">Naive Bayes</a></li><li><a class="tocitem" href="../examples/model_selection/">Model selection</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/add_new_models/">Implementing new Bayesian density estimators</a></li></ul></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>A primer on Bayesian nonparametric density estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A primer on Bayesian nonparametric density estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oskarhs/BayesDensity.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oskarhs/BayesDensity.jl/blob/main/docs/src/density_estimation_primer.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-primer-on-Bayesian-nonparametric-density-estimation"><a class="docs-heading-anchor" href="#A-primer-on-Bayesian-nonparametric-density-estimation">A primer on Bayesian nonparametric density estimation</a><a id="A-primer-on-Bayesian-nonparametric-density-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#A-primer-on-Bayesian-nonparametric-density-estimation" title="Permalink"></a></h1><p>The following page provides a short introduction to nonparametric density estimation, with a particular focus on Bayesian approaches. The topic of nonparametric density estimation is vast, and we do as such only aim to provide a rather broad overview here. For an in-depth and quite accessible introduction to frequentist approaches in nonparametric density estimation, we recommend <a href="../references/#Scott1992multivariate">Scott (1992)</a>. A good introduction to the Bayesian perspective, with a focus on practical computation, can be found in <a href="../references/#Gelman2013bayesian">Gelman <em>et al.</em> (2013)</a>.</p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>The goal of density estimation is to infer an unknown density based on observed data. Given an independent and identically distributed sample <span>$x_1, x_2, \ldots, x_n$</span> from a density <span>$f$</span>, the primary goal is to construct an estimate <span>$\hat{f}$</span> that is close to the true density. Parametric approaches to density estimation assume that the density belongs to a parametric family of distribution, such as the normal family of distributions, indexed by a parameter of low to moderate dimension. This approach is generally highly efficient if the true density belongs to or is well-approximated by a member of the postulated parametric family. However, in cases where the parametric family at hand is misspecified, the quality of the estimator <span>$\hat{f}$</span> is often of low quality.</p><p>In constrast, nonparametric approaches to density estimation strive to make less restrictive assumptions on the true density <span>$f$</span>. This aim is acheived by employing richer classes of models which are able to approximate the true density under minimal smoothness assumptions. Unlike their parametric counterparts, most nonparametric density estimators are built on high- or even infinite-dimensional parameter spaces.</p><p>Although the increased flexibility of nonparametric approaches is an attractive feature, it can be quite challenging to construct well-working nonparametric density estimators owing to the high-dimensional parameter spaces. In particular, the high dimensionality of the parameter space introduces the need for some form of regularization, typically through the introduction of one or several smoothing parameters, so that the resulting estimates do not end up being too bumpy. As an illustration, consider the well-known (frequentist) kernel density estimator:</p><p class="math-container">\[\hat{f}(x) = \frac{1}{nh}\sum_{i=1}^n \phi\Big(\frac{x - x_i}{h}\Big),\]</p><p>where <span>$\phi(\cdot)$</span> is the probability density function of the standard normal distribution and the bandwidth <span>$h &gt; 0$</span> is a parameter which controls the smoothness of the estimate. To illustrate the role of the smoothing parameter, we generated a sample of size <span>$n = 1000$</span> from the following mixture density</p><p class="math-container">\[f(x) = \frac{0.4}{0.25} \phi\Big(\frac{x+0.2}{0.25}\Big) + \frac{0.6}{0.15}\phi\Big(\frac{x-0.5}{0.15}\Big).\]</p><p>We then fitted a kernel density estimator for three different choices of the bandwidth parameter. The resulting density estimates are shown in the figure below:</p><p><img src="../assets/introduction_to_density_estimation/kernel.svg" alt="kernel density bandwidth"/></p><p>For the smallest choice of the bandwidth parameter, the estimate <span>$\hat{f}$</span> is very wiggly, severly distorting the shape of <span>$f$</span> with many small bumps. On the other hand, the largest bandwidth results in far too much smoothing, and the resulting density estimate fails to resemble <span>$f$</span>. A good choice of the bandwidth parameter needs to strike a balance between these two extremes.</p><p>In practical applications, the true density is of course not known, and one has to select the smoothing parameter in a data-driven manner. Frequentist approaches to selecting the smoothing parameter are often based on optimizing some criterion that balances representational capacity against model complexity. Examples include the optimization of a cross-validation criterion or the minimization of an asymptotic expansion of a risk function.</p><h2 id="The-Bayesian-approach"><a class="docs-heading-anchor" href="#The-Bayesian-approach">The Bayesian approach</a><a id="The-Bayesian-approach-1"></a><a class="docs-heading-anchor-permalink" href="#The-Bayesian-approach" title="Permalink"></a></h2><p>Bayesian statistics offers a fundamentally different approach to nonparametric density estimation. Here, the density <span>$f$</span> is itself treated as a random quantity, and is assigned a prior distribution <span>$p(f)$</span>. Density estimates in Bayesian models are based on the posterior distribution,</p><p class="math-container">\[p(f\,|\, x_1, \ldots, x_n) \propto p(f)\prod_{i=1}^n f(x_i).\]</p><p>Unlike frequentist approaches to smoothing parameter selection, where they are typically chosen via an optimization, the Bayesian approach implicitly introduces smoothing through the prior distribution. By utilizing a prior distribution that allows for <span>$f$</span> to be of varying degrees of smoothness, Bayesian procedures lead to data-driven choices to smoothing parameter(s) through the posterior distribution <span>$p(f\,|\, x_1, \ldots, x_n)$</span>. Although the posterior gives a full distribution over the density <span>$f$</span>, statisticians are often interested in providing a point estimate <span>$\hat{f}(x)$</span>, along with some uncertainty measure. A popular point estimate in the Bayesian setting is the posterior mean, <span>$\hat{f}(x) = \mathbb{E}[f(x)\,|\, x_1, \ldots, x_n]$</span>, while uncertainty quantification is usually provided in the form of a <span>$95 \%$</span> pointwise credible band, which is constructed by finding two functions <span>$l$</span> and <span>$u$</span> which satisfy <span>$P(l(x)\leq f(x) \leq u(x)\,|\, x_1, \ldots, x_n) = 0.95$</span> for all <span>$x$</span>. A key challenge in the Bayesian approach to density estimation is that for most genuinely nonparametric models, the posterior distribution <span>$p(f\,|\, x_1, \ldots, x_n)$</span> is often not tractable analytically, and as such, posterior summaries cannot be computed exactly. Instead, inference is mostly based on Monte Carlo approximations, where one generates samples <span>$f^{(1)}, \ldots, f^{(M)}$</span> from the posterior distribution of <span>$f$</span>, and uses them to approximate key posterior quantities. For instance, the posterior mean can be approximated by</p><p class="math-container">\[    \mathbb{E}[f(x)\,|\, x_1, \ldots, x_n] \approx \frac{1}{M}\sum_{m=1}^M f^{(m)}(x),\]</p><p>while approximate posterior credible bands can be constructed via the sample quantiles of <span>$f(x)$</span>.</p><h3 id="Markov-chain-Monte-Carlo"><a class="docs-heading-anchor" href="#Markov-chain-Monte-Carlo">Markov chain Monte Carlo</a><a id="Markov-chain-Monte-Carlo-1"></a><a class="docs-heading-anchor-permalink" href="#Markov-chain-Monte-Carlo" title="Permalink"></a></h3><p>Although the Monte Carlo method is a powerful technique for approximating key quantities of interest, the process of generating samples from the posterior distribution is less straightforward. Moreover, the high- to infinite dimensional nature of nonparametric procedures further complicate this issue, as the techniques employed for approximate inference in lower-dimensional Bayesian models often do not scale well to higher dimensions. The class of simulation schemes used to generate samples from the posterior distribution in the <code>BayesDensity</code> package are so-called Markov chain Monte Carlo (MCMC) methods. Here, one constructs a Markov chain <span>$f^{(1)}, \ldots, f^{(M)}$</span> of approximate samples form the posterior distribution, meaning that the distribution of <span>$f^{(m+1)}$</span> is in general dependent on the previous state <span>$f^{(m)}$</span>. Although the sequence of densities generated from such a sampler are dependent, it can be shown under rather mild conditions that Monte Carlo approximations based on these samples approach their corresponding true values as the number of samples diverges to infinity.</p><p>To illustrate the appliation of Markov chain Monte Carlo methods to Bayesian density estimation, we applied the implemented MCMC sampler to a <a href="../methods/HistSmoother/#HistSmoother"><code>HistSmoother</code></a> model with default hyperparameters based on the simulated sample from the two-component Gaussian mixture treated previously. The animation shown below displays the posterior draw <span>$f^{(m)}$</span> for the first <span>$200$</span> iterations of the sampler, along with the runnning mean.</p><p><img src="../assets/introduction_to_density_estimation/mcmc_animation.gif" alt="MCMC animation"/></p><p>For the first few draws, the samples <span>$f^{(m)}$</span> do not resemble the true density much due to the dependence on the initial value <span>$f^{(0)}$</span>.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup> However, it only takes the draws a few iterations to reach a stady state around which the remaining posterior draws fluctuate quickly. While there is considerable variation in the posterior draws of <span>$f$</span> after reaching the stationary distribution, the running mean of the draws stabilizes after a while, resulting in a density estimate which is quite close to the true data-generating density.</p><p>To estimate the true density, we ran the sampler for an additional 1900 iterations, and discarded the samples from the first 100 iterations to reduce the initialization bias in the estimates. The resulting approximations to the posterior mean and the <span>$95 \%$</span> pointwise credible bands are shown in the figure below.</p><p><img src="../assets/introduction_to_density_estimation/mcmc_estimate.svg" alt="MCMC estimate"/></p><h3 id="Variational-inference"><a class="docs-heading-anchor" href="#Variational-inference">Variational inference</a><a id="Variational-inference-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-inference" title="Permalink"></a></h3><p>Variational inference (VI) is a designation used to describe a class of methods that construct deterministic approximations to posterior distributions. The main benefit of the variational approach over Markov chain Monte Carlo methods is that the approximations to key posterior quantities are often of high quality, and that they are significantly faster to construct than generating a sufficient number of posterior draws via MCMC. Mathematically, variational approaches seek to find an approximation <span>$q(f)$</span> to the posterior <span>$p(f\,|\, x_1, \ldots, x_n)$</span>, where the density <span>$q$</span> belongs to a family of distributions that is easy to sample from. Most variational approaches are based on minimizing the <a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback–Leibler divergence</a> between <span>$q$</span> and the posterior, as this objective has certain mathematical properties that make it especially suitable for numerical optimization techniques. Having fitted a variational posterior, we can apply the Monte Carlo method to independent samples <span>$f^{(m)}\sim q(f)$</span> to compute e.g. the posterior mean.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2" class="footnote-ref">[2]</a><span class="footnote-preview" id="fn-2"></span></sup> Unlike estimates based on Markov chain Monte Carlo, where true posterior quantities can be recovered in the limit as the number of samples approaches infinity, variational approximations induce some irreducible error due to their approximate nature.</p><p>To illustrate the application of variational methods to density estimation, we return to the two-component normal mixture data considered previously. We have fitted a variational approximation to the same <code>HistSmoother</code> considered previously. The plot below shows the resulting approximate posterior mean and the <span>$95 \%$</span> pointwise credible bands.</p><p><img src="../assets/introduction_to_density_estimation/varinf_estimate.svg" alt="VI estimate"/></p><p>For this particular example, the estimates obtained from the variational approximation are in very close agreement to those obtained via MCMC. Note that the quality of the variational approximation is in general highly model-dependent, and you should not necessarily expect to see such close agreement between posterior draws via MCMC and the approximate VI posterior for all the models implemented in <code>BayesDensity</code>.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>The behavior observed in the animation, that the first few values of a Markov chain are not properly representative draws from the posterior distribution, is rather common when using Markov chain Monte Carlo methods. A common remedy to this fact is to use a so-called burn-in period, where one discards the samples from the first iterations of the sampler, in order to minimize any bias in posterior estimates caused by the initial values.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Analytical expressions for posterior means and credible intervals for <span>$f$</span> are often not available under <span>$q$</span>. In this case, we resort to a Monte Carlo approximation.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../api/general_api/">General API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 15 February 2026 17:20">Sunday 15 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
